(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}(g.pip || (g.pip = {})).help = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function () {
    'use strict';
    angular.module('pipHelp', [
        'pipHelp.Service',
        'pipHelp.Page'
    ]);
})();
},{}],2:[function(require,module,exports){
(function () {
    'use strict';
    config.$inject = ['$stateProvider'];
    HelpPageController.$inject = ['$rootScope', '$scope', '$state', 'pipAppBar', 'pipHelp'];
    angular.module('pipHelp.Page', ['ui.router', 'pipHelp.Service', 'pipAppBar', 'pipSelected', 'pipTranslate',
        'pipHelp.Templates'])
        .config(config)
        .controller('pipHelpPageController', HelpPageController);
    function config($stateProvider) {
        $stateProvider.state('help', {
            url: '/help',
            auth: false,
            controller: 'pipHelpPageController',
            templateUrl: 'help_page/help_page.html'
        });
    }
    function HelpPageController($rootScope, $scope, $state, pipAppBar, pipHelp) {
        $scope.tabs = _.filter(pipHelp.getTabs(), function (tab) {
            if (tab.visible && (tab.access !== angular.noop ? tab.access($rootScope.$user, tab) : true)) {
                return tab;
            }
        });
        $scope.selected = {};
        if ($state.current.name !== 'help') {
            initSelect($state.current.name);
        }
        else {
            initSelect(pipHelp.getDefaultTab().state);
        }
        appHeader();
        $scope.onNavigationSelect = onNavigationSelect;
        $scope.onDropdownSelect = onDropdownSelect;
        function onDropdownSelect(state) {
            onNavigationSelect(state.state);
        }
        function appHeader() {
            pipAppBar.showMenuNavIcon();
            pipAppBar.showTitleText('Help');
            pipAppBar.showShadowSm();
            pipAppBar.showLocalActions(null, []);
        }
        function onNavigationSelect(state) {
            initSelect(state);
            if ($scope.selected.tab) {
                $state.go(state);
            }
        }
        function initSelect(state) {
            $scope.selected.tab = _.find($scope.tabs, function (tab) {
                return tab.state === state;
            });
            $scope.selected.tabIndex = _.indexOf($scope.tabs, $scope.selected.tab);
            $scope.selected.tabId = state;
        }
    }
})();
},{}],3:[function(require,module,exports){
(function () {
    'use strict';
    angular.module('pipHelp.Service', ['ui.router'])
        .provider('pipHelp', ['$stateProvider', function ($stateProvider) {
        var defaultTab, tabs = [];
        this.addTab = addTab;
        this.setDefaultTab = setDefaultTab;
        this.getTabs = getTabs;
        this.getDefaultTab = getDefaultTab;
        this.$get = function () {
            return {
                getTabs: getTabs,
                getDefaultTab: getDefaultTab,
                addTab: addTab,
                setDefaultTab: setDefaultTab
            };
        };
        function getFullStateName(state) {
            return 'help.' + state;
        }
        function getTabs() {
            return _.cloneDeep(tabs);
        }
        function getDefaultTab() {
            return _.cloneDeep(_.find(tabs, function (tab) {
                return tab.state === defaultTab;
            }));
        }
        function addTab(tabObj) {
            var tab;
            validateTab(tabObj);
            tab = _.find(tabs, function (tab) {
                return tab.state === getFullStateName(tabObj.state);
            });
            if (tab) {
                throw new Error('Tab with state name "' + tabObj.state + '" is already registered');
            }
            tabs.push({
                state: getFullStateName(tabObj.state),
                title: tabObj.title,
                access: tabObj.access || angular.noop,
                visible: tabObj.visible || true,
                stateConfig: _.cloneDeep(tabObj.stateConfig)
            });
            $stateProvider.state(getFullStateName(tabObj.state), tabObj.stateConfig);
            if (_.isUndefined(defaultTab) && tabs.length === 1) {
                setDefaultTab(tabObj.state);
            }
        }
        function setDefaultTab(name) {
            var tab, error;
            tab = _.find(tabs, function (tab) {
                return tab.state === getFullStateName(name);
            });
            if (!tab) {
                error = new Error('Tab with state name "' + name + '" is not registered');
                throw error;
            }
            defaultTab = getFullStateName(name);
            $stateProvider.redirect('help', getFullStateName(name));
        }
        function validateTab(tabObj) {
            if (!tabObj || !_.isObject(tabObj)) {
                throw new Error('Invalid object');
            }
            if (!tabObj.state || tabObj.state === '') {
                throw new Error('Tab should have valid Angular UI router state name');
            }
            if (tabObj.access && !_.isFunction(tabObj.access)) {
                throw new Error('"access" should be a function');
            }
            if (!tabObj.stateConfig || !_.isObject(tabObj.stateConfig)) {
                throw new Error('Invalid state configuration object');
            }
        }
    }]);
})();
},{}],4:[function(require,module,exports){
(function(module) {
try {
  module = angular.module('pipHelp.Templates');
} catch (e) {
  module = angular.module('pipHelp.Templates', []);
}
module.run(['$templateCache', function($templateCache) {
  $templateCache.put('help_page/help_page.html',
    '<md-toolbar class="pip-appbar-ext"></md-toolbar><pip-document width="800" min-height="400"><div class="pip-menu-container pip-help" ng-if="manager !== false"><md-list class="pip-menu pip-simple-list hide-xs" pip-selected="selected.tabIndex" pip-selected-watch="selected.navId" pip-select="onNavigationSelect($event.id)"><md-list-item class="pip-simple-list-item pip-selectable" ng-repeat="tab in tabs track by tab.state" md-ink-ripple="" pip-id="{{::tab.state }}"><p>{{::tab.title | translate}}</p></md-list-item></md-list><div class="pip-content-container"><pip-dropdown class="hide-gt-xs" pip-actions="tabs" pip-dropdown-select="onDropdownSelect" pip-active-index="selected.tabIndex"></pip-dropdown><div class="pip-body layout-column flex" ui-view=""></div></div></div><div class="layout-column layout-align-center-center flex" ng-if="manager === false">{{::\'ERROR_400\' | translate}}</div></pip-document>');
}]);
})();



},{}]},{},[4,2,3,1])(4)
});

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvaGVscC50cyIsInNyYy9oZWxwX3BhZ2UvaGVscF9wYWdlLnRzIiwic3JjL2hlbHBfc2VydmljZS9oZWxwX3NlcnZpY2UudHMiLCJ0ZW1wL3BpcC13ZWJ1aS1oZWxwLWh0bWwubWluLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDS0EsQ0FBQztJQUNHLFlBQVksQ0FBQztJQUViLE9BQU8sQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFO1FBQ3RCLGlCQUFpQjtRQUNqQixjQUFjO0tBQ2pCLENBQUMsQ0FBQztBQUVQLENBQUMsQ0FBQyxFQUFFLENBQUM7O0FDUkwsQ0FBQztJQUNHLFlBQVksQ0FBQztJQUViLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLENBQUMsV0FBVyxFQUFFLGlCQUFpQixFQUFFLFdBQVcsRUFBRSxhQUFhLEVBQUUsY0FBYztRQUN0RyxtQkFBbUIsQ0FBQyxDQUFDO1NBQ3BCLE1BQU0sQ0FBQyxNQUFNLENBQUM7U0FDZCxVQUFVLENBQUMsdUJBQXVCLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztJQUU3RCxnQkFBZ0IsY0FBYztRQUMxQixjQUFjLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTtZQUN6QixHQUFHLEVBQUUsT0FBTztZQUNaLElBQUksRUFBRSxLQUFLO1lBQ1gsVUFBVSxFQUFFLHVCQUF1QjtZQUNuQyxXQUFXLEVBQUUsMEJBQTBCO1NBQzFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFtQkQsNEJBQTRCLFVBQVUsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxPQUFPO1FBRXRFLE1BQU0sQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsVUFBVSxHQUFRO1lBQ3hELEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMs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S0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUN2QyxNQUFNLElBQUksS0FBSyxDQUFDLG9EQUFvRCxDQUFDLENBQUM7WUFDMUUsQ0FBQztZQUVELEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLElBQUksQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ2hELE1BQU0sSUFBSSxLQUFLLENBQUMsK0JBQStCLENBQUMsQ0FBQztZQUNyRCxDQUFDO1lBRUQsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBVyxJQUFJLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN6RCxNQUFNLElBQUksS0FBSyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7WUFDMUQsQ0FBQztRQUNMLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUVmLENBQUMsQ0FBQyxFQUFFLENBQUM7O0FDN05MO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwi77u/LyoqXHJcbiAqIEBmaWxlIFJlZ2lzdHJhdGlvbiBvZiBhbGwgaGVscCBjb21wb25lbnRzXHJcbiAqIEBjb3B5cmlnaHQgRGlnaXRhbCBMaXZpbmcgU29mdHdhcmUgQ29ycC4gMjAxNC0yMDE2XHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgncGlwSGVscCcsIFtcclxuICAgICAgICAncGlwSGVscC5TZXJ2aWNlJyxcclxuICAgICAgICAncGlwSGVscC5QYWdlJ1xyXG4gICAgXSk7XHJcblxyXG59KSgpO1xyXG4iLCIvKipcclxuICogQGZpbGUgUGFnZSB0ZW1wbGF0ZSBmb3IgaGVscCBjb21wb25lbnRzXHJcbiAqIEBjb3B5cmlnaHQgRGlnaXRhbCBMaXZpbmcgU29mdHdhcmUgQ29ycC4gMjAxNC0yMDE2XHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgncGlwSGVscC5QYWdlJywgWyd1aS5yb3V0ZXInLCAncGlwSGVscC5TZXJ2aWNlJywgJ3BpcEFwcEJhcicsICdwaXBTZWxlY3RlZCcsICdwaXBUcmFuc2xhdGUnLFxyXG4gICAgICAgICdwaXBIZWxwLlRlbXBsYXRlcyddKVxyXG4gICAgICAgIC5jb25maWcoY29uZmlnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdwaXBIZWxwUGFnZUNvbnRyb2xsZXInLCBIZWxwUGFnZUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbmZpZygkc3RhdGVQcm92aWRlcikge1xyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdoZWxwJywge1xyXG4gICAgICAgICAgICB1cmw6ICcvaGVscCcsXHJcbiAgICAgICAgICAgIGF1dGg6IGZhbHNlLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAncGlwSGVscFBhZ2VDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdoZWxwX3BhZ2UvaGVscF9wYWdlLmh0bWwnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAbmdkb2MgY29udHJvbGxlclxyXG4gICAgICogQG5hbWUgcGlwSGVscC5QYWdlLnBpcEhlbHBQYWdlQ29udHJvbGxlclxyXG4gICAgICpcclxuICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICogVGhlIGNvbnRyb2xsZXIgaXMgdXNlZCBmb3IgdGhlIHJvb3QgSGVscCBjb21wb25lbnQuXHJcbiAgICAgKiBJdCBtYW5hZ2VzIGF2YWlsYWJsZSB0YWJzIHByb3ZpZGUgbmF2aWdhdGlvbiB0aHJvdWdoIHRob3NlIG9uZXMuXHJcbiAgICAgKlxyXG4gICAgICoge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9waXAtd2VidWkvcGlwLXdlYnVpLWhlbHAvYmxvYi9tYXN0ZXIvc3JjL2hlbHBfcGFnZS9oZWxwX3BhZ2UuanMjTDQwIFZpZXcgc291cmNlfVxyXG4gICAgICpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gJHJvb3RTY29wZSAgIFJvb3Qgc2NvcGUgb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gJHNjb3BlICAgICAgIFNjb3BlIGZvciB0aGUgY3VycmVudCBjb250cm9sbGVyXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gJHN0YXRlICAgICAgIFVJIFJvdXRlciBzZXJ2aWNlXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGlwQXBwQmFyICAgIFNlcnZpY2UgcHJvdmlkZXMgYW4gaW50ZXJmYWNlIHRvIG1hbmFnZSBvbiBhcHBsaWNhdGlvbiBiYXIgaGVhZGVyLlxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBpcEhlbHAgICAgICBTZXJ2aWNlIHRvIG1hbmFnZSB0aGlzIGNvbXBvbmVudCBiZWhhdmlvdXJcclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gSGVscFBhZ2VDb250cm9sbGVyKCRyb290U2NvcGUsICRzY29wZSwgJHN0YXRlLCBwaXBBcHBCYXIsIHBpcEhlbHApIHtcclxuXHJcbiAgICAgICAgJHNjb3BlLnRhYnMgPSBfLmZpbHRlcihwaXBIZWxwLmdldFRhYnMoKSwgZnVuY3Rpb24gKHRhYjogYW55KSB7XHJcbiAgICAgICAgICAgIGlmICh0YWIudmlzaWJsZSAmJiAodGFiLmFjY2VzcyAhPT0gYW5ndWxhci5ub29wID8gdGFiLmFjY2Vzcygkcm9vdFNjb3BlLiR1c2VyLCB0YWIpIDogdHJ1ZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YWI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAkc2NvcGUuc2VsZWN0ZWQgPSB7fTtcclxuXHJcbiAgICAgICAgaWYgKCRzdGF0ZS5jdXJyZW50Lm5hbWUgIT09ICdoZWxwJykge1xyXG4gICAgICAgICAgICBpbml0U2VsZWN0KCRzdGF0ZS5jdXJyZW50Lm5hbWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGluaXRTZWxlY3QocGlwSGVscC5nZXREZWZhdWx0VGFiKCkuc3RhdGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXBwSGVhZGVyKCk7XHJcblxyXG4gICAgICAgICRzY29wZS5vbk5hdmlnYXRpb25TZWxlY3QgPSBvbk5hdmlnYXRpb25TZWxlY3Q7XHJcbiAgICAgICAgJHNjb3BlLm9uRHJvcGRvd25TZWxlY3QgPSBvbkRyb3Bkb3duU2VsZWN0O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICogQG5hbWUgcGlwSGVscC5QYWdlLnBpcEhlbHBQYWdlQ29udHJvbGxlciNvbkRyb3Bkb3duU2VsZWN0XHJcbiAgICAgICAgICogQG1ldGhvZE9mIHBpcEhlbHAuUGFnZS5waXBIZWxwUGFnZUNvbnRyb2xsZXJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAqIEl0IHJlZGlyZWN0cyB0byBhIHBhc3NlZCBzdGF0ZS5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vcGlwLXdlYnVpL3BpcC13ZWJ1aS1oZWxwL2Jsb2IvbWFzdGVyL3NyYy9oZWxwX3BhZ2UvaGVscF9wYWdlLmpzI0w3MiBWaWV3IHNvdXJjZX1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzdGF0ZSAgICBTdGF0ZSBjb25maWd1cmF0aW9uIG9iamVjdFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uRHJvcGRvd25TZWxlY3Qoc3RhdGUpIHtcclxuICAgICAgICAgICAgb25OYXZpZ2F0aW9uU2VsZWN0KHN0YXRlLnN0YXRlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIENvbmZpZyBhcHBCYXIgZHVlIHRvIHRoaXMgcGFnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGFwcEhlYWRlcigpIHtcclxuICAgICAgICAgICAgcGlwQXBwQmFyLnNob3dNZW51TmF2SWNvbigpO1xyXG4gICAgICAgICAgICBwaXBBcHBCYXIuc2hvd1RpdGxlVGV4dCgnSGVscCcpO1xyXG4gICAgICAgICAgICBwaXBBcHBCYXIuc2hvd1NoYWRvd1NtKCk7XHJcbiAgICAgICAgICAgIHBpcEFwcEJhci5zaG93TG9jYWxBY3Rpb25zKG51bGwsIFtdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgKiBAbmFtZSBwaXBIZWxwLlBhZ2UucGlwSGVscFBhZ2VDb250cm9sbGVyI29uTmF2aWdhdGlvblNlbGVjdFxyXG4gICAgICAgICAqIEBtZXRob2RPZiBwaXBIZWxwLlBhZ2UucGlwSGVscFBhZ2VDb250cm9sbGVyXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBJdCByZWRpcmVjdHMgdG8gYSBwYXNzZWQgc3RhdGUuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL3BpcC13ZWJ1aS9waXAtd2VidWktaGVscC9ibG9iL21hc3Rlci9zcmMvaGVscF9wYWdlL2hlbHBfcGFnZS5qcyNMOTggVmlldyBzb3VyY2V9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3RhdGUgICAgTmFtZSBvZiB0aGUgdGFyZ2V0IHN0YXRlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uTmF2aWdhdGlvblNlbGVjdChzdGF0ZSkge1xyXG4gICAgICAgICAgICBpbml0U2VsZWN0KHN0YXRlKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuc2VsZWN0ZWQudGFiKSB7XHJcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oc3RhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBTZXQgc2VsZWN0ZWQgaXRlbSBmb3IgaGlnaGxpZ2h0aW5nIGluIHRoZSBuYXYgbWVudVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGluaXRTZWxlY3Qoc3RhdGUpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnNlbGVjdGVkLnRhYiA9IF8uZmluZCgkc2NvcGUudGFicywgZnVuY3Rpb24gKHRhYjogYW55KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFiLnN0YXRlID09PSBzdGF0ZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQudGFiSW5kZXggPSBfLmluZGV4T2YoJHNjb3BlLnRhYnMsICRzY29wZS5zZWxlY3RlZC50YWIpO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWQudGFiSWQgPSBzdGF0ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKCk7XHJcbiIsIi8qKlxyXG4gKiBAZmlsZSBTZXJ2aWNlIGZvciBoZWxwIGNvbXBvbmVudHNcclxuICogQGNvcHlyaWdodCBEaWdpdGFsIExpdmluZyBTb2Z0d2FyZSBDb3JwLiAyMDE0LTIwMTZcclxuICovXHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQG5nZG9jIHNlcnZpY2VcclxuICAgICAqIEBuYW1lIHBpcEhlbHAuU2VydmljZS5waXBIZWxwXHJcbiAgICAgKlxyXG4gICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgKiBUaGlzIHNlcnZpY2UgaXMgcHJvdmlkZWQgYW4gaW50ZXJmYWNlIHRvIG1hbmFnZSB0aGUgSGVscCBjb21wb25lbnQuXHJcbiAgICAgKiBJdCBpcyBhdmFpbGFibGUgb24gdGhlIGNvbmZpZyBhbmQgcnVuIGFwcGxpY2F0aW9uIHBoYXNlcy4gT24gdGhlIGJvdGggcGhhc2VzIHRoZSBpbnRlcmZhY2UgaXMgdGhlIHNhbWUuXHJcbiAgICAgKiBUaGlzIG1vZHVsZSByZXF1aXJlcyB0aGUgJyRzdGF0ZScgbW9kdWxlLlxyXG4gICAgICovXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgncGlwSGVscC5TZXJ2aWNlJywgWyd1aS5yb3V0ZXInXSlcclxuICAgICAgICAucHJvdmlkZXIoJ3BpcEhlbHAnLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpOiBhbnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRUYWIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGFicyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKiBAc2VlIGFkZFRhYiAqL1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRUYWIgPSBhZGRUYWI7XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqIEBzZWUgc2V0RGVmYXVsdFRhYiAqL1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXREZWZhdWx0VGFiID0gc2V0RGVmYXVsdFRhYjtcclxuXHJcbiAgICAgICAgICAgICAgICAvKiogQHNlZSBnZXRUYWJzICovXHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRhYnMgPSBnZXRUYWJzO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKiBAc2VlIGdldERlZmF1bHRUYWIgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0RGVmYXVsdFRhYiA9IGdldERlZmF1bHRUYWI7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKiBAc2VlIGdldFRhYnMgKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0VGFiczogZ2V0VGFicyxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKiBAc2VlIGdldERlZmF1bHRUYWIgKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0RGVmYXVsdFRhYjogZ2V0RGVmYXVsdFRhYixcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKiBAc2VlIGFkZFRhYiAqL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRUYWI6IGFkZFRhYixcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKiBAc2VlIHNldERlZmF1bHRUYWIgKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RGVmYXVsdFRhYjogc2V0RGVmYXVsdFRhYlxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogVGhpcyBtZXRob2QgYnVpbGQgdGhlIGZ1bGwgbmFtZSBvZiBzdGF0ZSB3aXRoaW4gdGhlIGFic3RyYWN0ICdoZWxwJyBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRGdWxsU3RhdGVOYW1lKHN0YXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdoZWxwLicgKyBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIEBuZ2RvYyBtZXRob2RcclxuICAgICAgICAgICAgICAgICAqIEBuYW1lIHBpcEhlbHAuU2VydmljZS5waXBIZWxwI2dldFRhYnNcclxuICAgICAgICAgICAgICAgICAqIEBtZXRob2RPZiBwaXBIZWxwLlNlcnZpY2UucGlwSGVscFxyXG4gICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAgICAgICAgICogVGhpcyBtZXRob2QgcmV0dXJucyBhc3NldCBvZiBhbGwgdGFicyByZWdpc3RlcmVkIGluIHRoZSBIZWxwIGNvbXBvbmVudC5cclxuICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL3BpcC13ZWJ1aS9waXAtd2VidWktaGVscC9ibG9iL21hc3Rlci9zcmMvaGVscF9zZXJ2aWNlL2hlbHBfc2VydmljZS5qcyNMNzkgVmlldyBzb3VyY2V9XHJcbiAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge0FycmF5PE9iamVjdD59IExpc3Qgb2YgcmVnaXN0ZXJlZCBzdGF0ZXNcclxuICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAgICAgICAgICogPHByZT5cclxuICAgICAgICAgICAgICAgICAqIC8vIG9uIHRoZSBjb25maWcgcGhhc2VcclxuICAgICAgICAgICAgICAgICAqIHBpcEhlbHBQcm92aWRlci5nZXRUYWJzKCk7XHJcbiAgICAgICAgICAgICAgICAgKiA8L3ByZT5cclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0VGFicygpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXy5jbG9uZURlZXAodGFicyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICAgICAgICAgKiBAbmFtZSBwaXBIZWxwLlNlcnZpY2UucGlwSGVscCNnZXREZWZhdWx0VGFiXHJcbiAgICAgICAgICAgICAgICAgKiBAbWV0aG9kT2YgcGlwSGVscC5TZXJ2aWNlLnBpcEhlbHBcclxuICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAgICAgICAgICAgICAqIFRoaXMgbWV0aG9kIHJldHVybiBuYW1lIG9mIHRoZSBkZWZhdWx0IHN0YXRlLlxyXG4gICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vcGlwLXdlYnVpL3BpcC13ZWJ1aS1oZWxwL2Jsb2IvbWFzdGVyL3NyYy9oZWxwX3NlcnZpY2UvaGVscF9zZXJ2aWNlLmpzI0wxMDEgVmlldyBzb3VyY2V9XHJcbiAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge3N0cmluZ30gTmFtZSBvZiB0aGUgc3RhdGVcclxuICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAgICAgICAgICogPHByZT5cclxuICAgICAgICAgICAgICAgICAqIC8vIG9uIHRoZSBjb25maWcgcGhhc2VcclxuICAgICAgICAgICAgICAgICAqIHBpcEhlbHBQcm92aWRlci5nZXREZWZhdWx0VGFiKCk7XHJcbiAgICAgICAgICAgICAgICAgKiA8L3ByZT5cclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0RGVmYXVsdFRhYigpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXy5jbG9uZURlZXAoXy5maW5kKHRhYnMsIGZ1bmN0aW9uICh0YWIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYi5zdGF0ZSA9PT0gZGVmYXVsdFRhYjtcclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAgICAgKiBAbmdkb2MgbWV0aG9kXHJcbiAgICAgICAgICAgICAgICAgKiBAbmFtZSBwaXBIZWxwLlNlcnZpY2UucGlwSGVscCNhZGRUYWJcclxuICAgICAgICAgICAgICAgICAqIEBtZXRob2RPZiBwaXBIZWxwLlNlcnZpY2UucGlwSGVscFxyXG4gICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAqIEBkZXNjcmlwdGlvblxyXG4gICAgICAgICAgICAgICAgICogVGhpcyBtZXRob2QgYWxsb3dzIGFkZCBuZXcgdGFiIGludG8gbmF2aWdhdGlvbiBtZW51LiBJdCBhY2NlcHRzIGNvbmZpZyBvYmplY3QgdG8gZGVmaW5lIG5ldyBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICogd2l0aCBuZWVkZWQgcGFyYW1zLlxyXG4gICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vcGlwLXdlYnVpL3BpcC13ZWJ1aS1oZWxwL2Jsb2IvbWFzdGVyL3NyYy9oZWxwX3NlcnZpY2UvaGVscF9zZXJ2aWNlLmpzI0wxMzkgVmlldyBzb3VyY2V9XHJcbiAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHRhYk9iaiBDb25maWd1cmF0aW9uIG9iamVjdCBjb250YWlucyBzZXR0aW5ncyBmb3IgYW5vdGhlciB0YWJcclxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7T2JqZWN0LjxzdHJpbmc+fSB0YWJPYmouc3RhdGUgICBOYW1lIG9mIHRhYiBzdGF0ZSB3aGljaCBpcyBhdmFpbGFibGUgdmlhIFVJIHJvdXRlclxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3QuPHN0cmluZz59IHRhYk9iai50aXRsZSAgIFRhYiB0aXRsZSBpbiB0aGUgbmF2aWdhdGlvbiBtZW51LlxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3QuPGJvb2xlYW4+fSB0YWJPYmouYWNjZXNzIElmIGl0IGlzIHRydWUgaXQgd2lsbCBiZSBhdmFpbGFibGUgb25seSBmb3IgbG9nZ2VkIGluIHVzZXJzXHJcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdC48Ym9vbGVhbj59IHRhYk9iai52aXNpYmxlIElmIGl0IGlzIHRydWUgdGhlIHRhYiB3aWxsIGJlIHZpc2libGVcclxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7T2JqZWN0LjxPYmplY3Q+fSB0YWJPYmouc3RhdGVDb25maWcgIENvbmZpZ3VyYXRpb24gb2JqZWN0IGluIGZvcm1hdCBsaWtlIFVJIFJvdXRlciBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAqIEBleGFtcGxlXHJcbiAgICAgICAgICAgICAgICAgKiA8cHJlPlxyXG4gICAgICAgICAgICAgICAgICogIC8vIG9uIHRoZSBjb25maWcgcGhhc2VcclxuICAgICAgICAgICAgICAgICAqICBwaXBIZWxwUHJvdmlkZXIuYWRkVGFiKHtcclxuICAgICAgICAgICAgICAgICAqICAgICAgc3RhdGU6ICd0ZXN0JyxcclxuICAgICAgICAgICAgICAgICAqICAgICAgdGl0bGU6ICdUZXN0IGhlbHAgdGFiJyxcclxuICAgICAgICAgICAgICAgICAqICAgICAgYXV0aDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAqICAgICAgc3RhdGVDb25maWc6IHtcclxuICAgICAgICAgICAgICAgICAqICAgICAgICAgIHVybDogJy90ZXN0JyxcclxuICAgICAgICAgICAgICAgICAqICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaGVscC9oZWxwX3Rlc3QxLmh0bWwnXHJcbiAgICAgICAgICAgICAgICAgKiAgICAgIH1cclxuICAgICAgICAgICAgICAgICAqICB9KTtcclxuICAgICAgICAgICAgICAgICAqIDwvcHJlPlxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhZGRUYWIodGFiT2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGVUYWIodGFiT2JqKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGFiID0gXy5maW5kKHRhYnMsIGZ1bmN0aW9uICh0YWIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYi5zdGF0ZSA9PT0gZ2V0RnVsbFN0YXRlTmFtZSh0YWJPYmouc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUYWIgd2l0aCBzdGF0ZSBuYW1lIFwiJyArIHRhYk9iai5zdGF0ZSArICdcIiBpcyBhbHJlYWR5IHJlZ2lzdGVyZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHRhYnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlOiBnZXRGdWxsU3RhdGVOYW1lKHRhYk9iai5zdGF0ZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiB0YWJPYmoudGl0bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VzczogdGFiT2JqLmFjY2VzcyB8fCBhbmd1bGFyLm5vb3AsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpc2libGU6IHRhYk9iai52aXNpYmxlIHx8IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ29uZmlnOiBfLmNsb25lRGVlcCh0YWJPYmouc3RhdGVDb25maWcpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKGdldEZ1bGxTdGF0ZU5hbWUodGFiT2JqLnN0YXRlKSwgdGFiT2JqLnN0YXRlQ29uZmlnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgd2UganVzdCBhZGRlZCBmaXJzdCBzdGF0ZSBhbmQgbm8gZGVmYXVsdCBzdGF0ZSBpcyBzcGVjaWZpZWRcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXy5pc1VuZGVmaW5lZChkZWZhdWx0VGFiKSAmJiB0YWJzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXREZWZhdWx0VGFiKHRhYk9iai5zdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICogQG5nZG9jIG1ldGhvZFxyXG4gICAgICAgICAgICAgICAgICogQG5hbWUgcGlwSGVscC5TZXJ2aWNlLnBpcEhlbHAjc2V0RGVmYXVsdFRhYlxyXG4gICAgICAgICAgICAgICAgICogQG1ldGhvZE9mIHBpcEhlbHAuU2VydmljZS5waXBIZWxwXHJcbiAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICogQGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICAgICAgICAgKiBUaGlzIG1ldGhvZCBlc3RhYmxpc2hlcyBwYXNzZWQgc3RhdGUgYXMgZGVmYXVsdCB3aGljaCBpcyByZWRpcmVjdGVkIGF0IGFmdGVyIHRyYW5zZmVyIG9uIGFic3RyYWN0XHJcbiAgICAgICAgICAgICAgICAgKiBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAqIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vcGlwLXdlYnVpL3BpcC13ZWJ1aS1oZWxwL2Jsb2IvbWFzdGVyL3NyYy9oZWxwX3NlcnZpY2UvaGVscF9zZXJ2aWNlLmpzI0wxODUgVmlldyBzb3VyY2V9XHJcbiAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IG5hbWUgICAgIE5hbWUgb2YgdGhlIHN0YXRlXHJcbiAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgICAgICAgICAqIDxwcmU+XHJcbiAgICAgICAgICAgICAgICAgKiBwaXBIZWxwUHJvdmlkZXIuc2V0RGVmYXVsdFRhYigndGVzdCcpO1xyXG4gICAgICAgICAgICAgICAgICogPC9wcmU+XHJcbiAgICAgICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNldERlZmF1bHRUYWIobmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0YWIsIGVycm9yO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0YWIgPSBfLmZpbmQodGFicywgZnVuY3Rpb24gKHRhYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFiLnN0YXRlID09PSBnZXRGdWxsU3RhdGVOYW1lKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yID0gbmV3IEVycm9yKCdUYWIgd2l0aCBzdGF0ZSBuYW1lIFwiJyArIG5hbWUgKyAnXCIgaXMgbm90IHJlZ2lzdGVyZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VGFiID0gZ2V0RnVsbFN0YXRlTmFtZShuYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXIucmVkaXJlY3QoJ2hlbHAnLCBnZXRGdWxsU3RhdGVOYW1lKG5hbWUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIFRoaXMgbWV0aG9kIHZhbGlkYXRlcyBwYXNzZWQgc3RhdGUuXHJcbiAgICAgICAgICAgICAgICAgKiBJZiBpdCBpcyBpbmNvcnJlY3QgaXQgd2lsbCB0aHJvdyBhbiBlcnJvci5cclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gdmFsaWRhdGVUYWIodGFiT2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0YWJPYmogfHwgIV8uaXNPYmplY3QodGFiT2JqKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgb2JqZWN0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRhYk9iai5zdGF0ZSB8fCB0YWJPYmouc3RhdGUgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGFiIHNob3VsZCBoYXZlIHZhbGlkIEFuZ3VsYXIgVUkgcm91dGVyIHN0YXRlIG5hbWUnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YWJPYmouYWNjZXNzICYmICFfLmlzRnVuY3Rpb24odGFiT2JqLmFjY2VzcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdcImFjY2Vzc1wiIHNob3VsZCBiZSBhIGZ1bmN0aW9uJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRhYk9iai5zdGF0ZUNvbmZpZyB8fCAhXy5pc09iamVjdCh0YWJPYmouc3RhdGVDb25maWcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdGF0ZSBjb25maWd1cmF0aW9uIG9iamVjdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG59KSgpO1xyXG4iLCIoZnVuY3Rpb24obW9kdWxlKSB7XG50cnkge1xuICBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgncGlwSGVscC5UZW1wbGF0ZXMnKTtcbn0gY2F0Y2ggKGUpIHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ3BpcEhlbHAuVGVtcGxhdGVzJywgW10pO1xufVxubW9kdWxlLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCdoZWxwX3BhZ2UvaGVscF9wYWdlLmh0bWwnLFxuICAgICc8bWQtdG9vbGJhciBjbGFzcz1cInBpcC1hcHBiYXItZXh0XCI+PC9tZC10b29sYmFyPjxwaXAtZG9jdW1lbnQgd2lkdGg9XCI4MDBcIiBtaW4taGVpZ2h0PVwiNDAwXCI+PGRpdiBjbGFzcz1cInBpcC1tZW51LWNvbnRhaW5lciBwaXAtaGVscFwiIG5nLWlmPVwibWFuYWdlciAhPT0gZmFsc2VcIj48bWQtbGlzdCBjbGFzcz1cInBpcC1tZW51IHBpcC1zaW1wbGUtbGlzdCBoaWRlLXhzXCIgcGlwLXNlbGVjdGVkPVwic2VsZWN0ZWQudGFiSW5kZXhcIiBwaXAtc2VsZWN0ZWQtd2F0Y2g9XCJzZWxlY3RlZC5uYXZJZFwiIHBpcC1zZWxlY3Q9XCJvbk5hdmlnYXRpb25TZWxlY3QoJGV2ZW50LmlkKVwiPjxtZC1saXN0LWl0ZW0gY2xhc3M9XCJwaXAtc2ltcGxlLWxpc3QtaXRlbSBwaXAtc2VsZWN0YWJsZVwiIG5nLXJlcGVhdD1cInRhYiBpbiB0YWJzIHRyYWNrIGJ5IHRhYi5zdGF0ZVwiIG1kLWluay1yaXBwbGU9XCJcIiBwaXAtaWQ9XCJ7ezo6dGFiLnN0YXRlIH19XCI+PHA+e3s6OnRhYi50aXRsZSB8IHRyYW5zbGF0ZX19PC9wPjwvbWQtbGlzdC1pdGVtPjwvbWQtbGlzdD48ZGl2IGNsYXNzPVwicGlwLWNvbnRlbnQtY29udGFpbmVyXCI+PHBpcC1kcm9wZG93biBjbGFzcz1cImhpZGUtZ3QteHNcIiBwaXAtYWN0aW9ucz1cInRhYnNcIiBwaXAtZHJvcGRvd24tc2VsZWN0PVwib25Ecm9wZG93blNlbGVjdFwiIHBpcC1hY3RpdmUtaW5kZXg9XCJzZWxlY3RlZC50YWJJbmRleFwiPjwvcGlwLWRyb3Bkb3duPjxkaXYgY2xhc3M9XCJwaXAtYm9keSBsYXlvdXQtY29sdW1uIGZsZXhcIiB1aS12aWV3PVwiXCI+PC9kaXY+PC9kaXY+PC9kaXY+PGRpdiBjbGFzcz1cImxheW91dC1jb2x1bW4gbGF5b3V0LWFsaWduLWNlbnRlci1jZW50ZXIgZmxleFwiIG5nLWlmPVwibWFuYWdlciA9PT0gZmFsc2VcIj57ezo6XFwnRVJST1JfNDAwXFwnIHwgdHJhbnNsYXRlfX08L2Rpdj48L3BpcC1kb2N1bWVudD4nKTtcbn1dKTtcbn0pKCk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBpcC13ZWJ1aS1oZWxwLWh0bWwubWluLmpzLm1hcFxuIl19